{% extends "base.html" %}
{% block content %}
<div class="panel pixel-border">
  <h2 style="color:#ffed4e">🍺 Tavern</h2>
  <div style="height:300px;overflow:auto;background:#111;padding:8px;border:2px solid #000;color:#fff;">
    {% for m in messages %}
      <div style="margin-bottom:6px;"><strong>{{ m.sender_id and (m.sender_id|int) or 'System' }}:</strong> {{ m.body }}</div>
    {% else %}
      <div>No messages yet.</div>
    {% endfor %}
  </div>

  <div style="margin-top:8px;">
    <input id="msg" placeholder="Say something..." style="width:70%;padding:8px;">
    <button class="action-btn" onclick="send()">SEND</button>
    <button class="action-btn" onclick="drink()">HAVE A DRINK</button>
  </div>
  <div style="margin-top:12px;"><a href="{{ url_for('game') }}" class="action-btn">← Back</a></div>
</div>

<script>
function send() {
  const body = document.getElementById('msg').value;
  fetch('/api/message/send', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ body: body, is_tavern: true })
  }).then(r=>r.json()).then(j=>{ if (j.ok) location.reload(); else alert('err'); });
}
function drink() {
  fetch('/api/message/send', {
    method:'POST', headers:{'Content-Type':'application/json'},
    body: JSON.stringify({ body: 'has a drink 🍻', is_tavern: true })
  }).then(r=>r.json()).then(j=>{ if (j.ok) location.reload(); else alert('err'); });
}
</script>
{% endblock %}
